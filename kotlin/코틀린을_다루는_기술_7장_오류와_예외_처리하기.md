# 코틀린을 다루는 기술

## 7장 오류와 예외 처리하기

### 데이터가 없는 경우와 관련한 문제
- 데이터가 없는 이유의 대부분은 입력 데이터 혹은 계산에서 발생한 오류 때문이다.
- 만약 사용자가 빈 문자열을 입력한다면 어떻게 해야할까?
- 입력 을 검사해 Option<String> 을 반환하는것이 해법이다. 올바르지 않다면 None 을 반환해야 한다.
- 이를 감안한 프로그램은 다음과 같다.

```kotlin
fun getName(): Option<String> = try {
    validate(readLine())
} catch (e: IOException) {
    Option()
}

fun validate(name: String?): Option<String> = when {
    name?.isNotEmpty() ?: false -> Option(name)
    else -> Option()
}

val toon = getName().flatMap(toons::getOption)
        .flatMap(Toon::email)

toon.getOrElse { "No data" }
```
- 어떤 일이 벌어졌는지에 따라 콘솔에 서로 다른 메시지가 표시되어야 한다.
- Pair 를 사용한다면 Pair<Option<T>, Option<String>> 을 각 함수의 반환타입으로 사용할 수 있지만 이는 너무 복잡하다.
- 오류가 있는 경우와 없는경우 배타적이지만, 여기서는 그런 배타성을 강제할 수 없다.
- Pair<Option<T>, Option<U>> 를 사용할때, T의 값이 Some 이라면, 반대쪽은 None 이여야 한다.
- 필요한 것은 **합 타입 (sum type)** 이다.
- 파라미터화 한 합 타입 E<T, U> 가 합타입이라는 의미는 T 나 U 의 타입의 값중 하나만 저장될 수 있고, 모두 다 저장될수 없다는 것이다.
- 이런 타입을 합타입이라고 부르는 이유는, E<T, U> 타입의 가능한 모든 값의 수는 T 타입의 갯수와 U 타입 값의 갯수를 더한것이기 때문이다.
- 이부분이 Pair<T, U> 와 같은 곱타입과 다른점이다.
- 곱타입은 Pair<T, U> 는 모든 가능한 값의 갯수가 T 의 갯수와 U 의 갯수를 곱한것이 된다.