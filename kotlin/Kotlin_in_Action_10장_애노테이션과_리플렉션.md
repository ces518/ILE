# Kotlin in Action

## 10장 애노테이션과 리플렉션

#### 애노테이션 선언과 적용
- 코틀린 애노테이션도 자바 애노테이션과 개념은 동일하다.
- 메타 데이터를 선언에 추가할 경우 애노테이션을 처리하는 도구가 컴파일 혹은 실행 시점에 적절한 처리를 한다.

#### 애노테이션 적용
- 자바와 동일한 방법으로 애노테이션 사용이 가능하다.
- @Deprecated 애노테이션을 예로 살펴보면 자바와 코틀린에서 의미는 동일하다.
- 하지만 코틀린에서는 replaceWith 파라메터를 통해 이전 버전을 대신할 패턴을 제시할 수 있다.

```kotlin
/**
 * 코틀린의 @Deprecated 는 자바와 동일한 의미를 가진다.
 * 하지만 ReplaceWith 파라메터를 통해 이전 버전을 대신할 패턴을 제시할 수 있다.
 */
@Deprecated("Use removeAt(index) instead. ", ReplaceWith("remoteAt(index)"))
fun remove(index: Int) { /* ... */ }
```

> 애노테이션의 인자는 원시 타입, 문자열, enum 클래스, 다른 애노테이션, 배열 이 들어갈 수 있다.

##### 애노테이션의 문법
- 클래스를 애노테이션 인자로 지정할 때는 @MyAnnotation(MyClass::class) 와 같이 ::class 를 클래스 명 뒤에 넣어야 함
- 다른 애노테이션을 인자로 사용 할 때 애노테이션 이름 앞에 @ 을 사용하지 않아야 함
- 배열을 인자로 지정하려면 arrayOf() 함수를 사용해야 한다.
- 애노테이션의 인자는 컴파일 시점에 알 수 있어야 한다. 프로퍼티를 인자로 사용하려면 const 변경자를 사용해 상수로 만들어야 한다.

#### 애노테이션 대상
- 애노테이션을 붙일때 예를 들어 getter 혹은 setter 에 애노테이션을 붙일지 표시할 필요가 생긴다.
- **사용 지점 대상 (use-site target)** 선언으로 애노테이션을 붙일 요소를 정할 수 있다.
```kotlin
@get:Rule
```
- 위 코드는 프로퍼티 getter 에 @Rule 애노테이션을 적용 하라는 의미이다.
- 자바에 선언된 애노테이션을 사용해서 프로퍼티에 애노테이션을 사용하는 경우 기본적으로 프로퍼티의 필드에 적용된다.
- 코틀린으로 선언된 애노테이션을 사용하면 프로퍼티에 직접 적용 가능한 애노테이션을 만들 수 있다.

`사용 지점 대상 지정시 지원 목록`
1. property - 프로퍼티 전체, 자바에서 선언된 경우에는 사용 불가능
2. field - 프로퍼티에 의해 생성되는 (뒷받침) 필드
3. get - 프로퍼티 게터
4. set - 프로퍼티 세터
5. receiver - 확장 함수 혹은 프로퍼티의 수신 객체 파라미터
6. param - 생성자 파라미터
7. setparam - 세터 파라미터
8. delegate - 위임 프로퍼티의 위임 인스턴스를 담아둔 필드
9. file - 파일 내에 선언된 최상위 함수와 프로퍼티를 담아두는 클래스

#### 자바 API를 애노테이션으로 제어
- 코틀린은 코틀린으로 선언한 내용을 자바 바이트코드로 컴파일 하는 방법과 코틀린 선언을 자바에 노출하는 방법을 제어하기 위한 애노테이션들을 제공한다.
- 예를들면 @Volatile 과 @Strictfp 애노테이션은 자바의 volatile 과 strictfp 키워드를 대신한다.

#### 애노테이션을 활용한 JSON 직렬화 제어
- **직렬화 (Serialization)** 는 객체를 저장장치에 저장하거나 네트워크를 통해 전송하기 위한 형식으로 변환 하는것
- **역직렬화 (DeSerialization)** 는 반대로 원래의 객체로 변환하는 것이다.

